import { Meta, Story } from '@storybook/addon-docs/blocks';
import * as fktBadgeSelectorStories from './fkt-badge-selector.stories';

<Meta of={fktBadgeSelectorStories} />

The **FktBadgeSelector** component provides an interactive dropdown for selecting from a list of badge options. Built with Angular signals and the overlay system, it offers a clean interface for choosing status, categories, or other badge-represented values.

## Key Features

- **Interactive Selection**: Click to open dropdown with available badge options
- **Visual Preview**: Shows currently selected badge with proper styling
- **Overlay System**: Uses smart positioning to avoid viewport overflow
- **Type Safety**: Generic component with strongly typed ID values
- **Two-Way Binding**: Seamless integration with reactive forms and signals
- **Keyboard Navigation**: Full accessibility support with keyboard interaction
- **Signal-Based**: Built with Angular signals for optimal performance

## Configuration Options

### Input Properties
- **`options`** (required): `FktBadge<Id>[]` - Array of badge options to display
- **`currentBadgeId`**: `Id` - Currently selected badge ID (supports two-way binding)

### FktBadge Interface
```typescript
interface FktBadge<Id extends string = string> {
  id: Id;           // Unique identifier for the badge option
  name: string;     // Display text shown in the badge
  color: FktBadgeColor; // Badge color (green, red, blue, orange)
}
```

### Two-Way Binding
The component supports Angular's two-way binding syntax:
```typescript
[(currentBadgeId)]="selectedValue"
```

## Use Cases

### Status Management
Perfect for managing entity status:
- Order and shipping status
- Project and task status
- User account status
- System health indicators

### Category Selection
Ideal for categorization interfaces:
- Content categories
- Product classifications
- Department assignments
- Priority levels

### Team and Assignment
Great for team management:
- Team member assignments
- Department selection
- Role assignments
- Responsibility areas

### Configuration
Essential for settings and preferences:
- Theme and appearance
- Notification preferences
- Access levels
- Feature toggles

## Accessibility

- **Keyboard Navigation**: Full keyboard support for opening and navigating options
- **Screen Reader Support**: Proper ARIA labels and announcements
- **Focus Management**: Logical focus flow between selector and options
- **High Contrast**: Supports system high contrast modes
- **State Communication**: Selection changes are clearly communicated

## Performance

- **Lazy Loading**: Dropdown content created only when opened
- **Efficient Rendering**: Optimized change detection with Angular signals
- **Memory Management**: Proper cleanup of overlay references
- **Type Safety**: Compile-time type checking for badge IDs

## Examples

### Basic Badge Selector

Interactive badge selector with predefined status options. Click to open dropdown and select an option.

<Story of={fktBadgeSelectorStories.Preview} />

```typescript
@Component({
  selector: 'app-example',
  template: `
    <fkt-badge-selector
      [options]="statusOptions"
      [(currentBadgeId)]="selectedStatus"
    />
  `,
  standalone: true,
  imports: [FktBadgeSelectorComponent]
})
export class ExampleComponent {
  selectedStatus = signal<string>('opt-1');

  statusOptions = [
    {
      id: "opt-1",
      color: "green" as const,
      name: "Success"
    },
    {
      id: "opt-2",
      color: "red" as const,
      name: "Cancelled"
    },
    {
      id: "opt-3",
      color: "blue" as const,
      name: "Reserved"
    },
    {
      id: "opt-4",
      color: "orange" as const,
      name: "Paused"
    }
  ];
}
```

### Order Status Selector

Badge selector for managing order status with multiple workflow states.

<Story of={fktBadgeSelectorStories.OrderStatus} />

```typescript
@Component({
  selector: 'app-example',
  template: `
    <div class="space-y-4">
      <div class="flex items-center gap-3">
        <span class="text-sm font-medium">Order #1234 Status:</span>
        <fkt-badge-selector
          [options]="orderStatusOptions"
          [(currentBadgeId)]="currentOrderStatus"
        />
      </div>

      <div class="text-sm text-gray-600">
        Current status: {{ getCurrentStatusLabel() }}
      </div>
    </div>
  `,
  standalone: true,
  imports: [FktBadgeSelectorComponent]
})
export class ExampleComponent {
  orderStatusOptions = [
    { id: "pending", color: "orange" as const, name: "Pending" },
    { id: "confirmed", color: "blue" as const, name: "Confirmed" },
    { id: "processing", color: "blue" as const, name: "Processing" },
    { id: "shipped", color: "blue" as const, name: "Shipped" },
    { id: "delivered", color: "green" as const, name: "Delivered" },
    { id: "cancelled", color: "red" as const, name: "Cancelled" }
  ];

  currentOrderStatus = signal<string>('confirmed');

  getCurrentStatusLabel(): string {
    const status = this.orderStatusOptions.find(b => b.id === this.currentOrderStatus());
    return status ? status.name : 'None';
  }
}
```

### Priority Level Selector

Badge selector for task or issue priority levels with visual hierarchy.

<Story of={fktBadgeSelectorStories.Priority} />

```typescript
@Component({
  selector: 'app-example',
  template: `
    <div class="p-4 border rounded-lg">
      <h3 class="text-lg font-semibold mb-3">Task Priority</h3>

      <div class="flex items-center gap-3">
        <label class="text-sm font-medium">Priority Level:</label>
        <fkt-badge-selector
          [options]="priorityOptions"
          [(currentBadgeId)]="selectedPriority"
        />
      </div>

      <div class="mt-3 text-sm text-gray-600">
        {{ getPriorityDescription() }}
      </div>
    </div>
  `,
  standalone: true,
  imports: [FktBadgeSelectorComponent]
})
export class ExampleComponent {
  priorityOptions = [
    { id: "low", color: "green" as const, name: "Low" },
    { id: "medium", color: "orange" as const, name: "Medium" },
    { id: "high", color: "red" as const, name: "High" },
    { id: "critical", color: "red" as const, name: "Critical" }
  ];

  selectedPriority = signal<string>('medium');

  getPriorityDescription(): string {
    const descriptions = {
      low: 'Tasks that can be completed when time permits',
      medium: 'Tasks that should be completed within normal timeframes',
      high: 'Tasks requiring prompt attention and completion',
      critical: 'Urgent tasks requiring immediate action'
    };

    return descriptions[this.selectedPriority() as keyof typeof descriptions] || 'Select a priority level';
  }
}
```
