/*! For license information please see 9399.40f9a7f7.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkfrakton_ng=self.webpackChunkfrakton_ng||[]).push([[9399],{"./node_modules/.pnpm/@angular+forms@21.0.0-next._995291d5b62b938228baf94d391065de/node_modules/@angular/forms/fesm2022/signals.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bp:()=>minLength,Ec:()=>Control,Ps:()=>applyWhen,Rp:()=>email,Ru:()=>maxLength,V_:()=>required,Zd:()=>form,r9:()=>disabled,tA:()=>submit,tf:()=>validate});var C_Users_samuel_programming_frakton_ng_node_modules_pnpm_babel_runtime_7_28_4_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@angular+core@21.0.0-next.3_a2881388d2c3dd57da73d8c3b030ded7/node_modules/@angular/core/fesm2022/debug_node.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@angular+core@21.0.0-next.3_a2881388d2c3dd57da73d8c3b030ded7/node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@angular+core@21.0.0-next.3_a2881388d2c3dd57da73d8c3b030ded7/node_modules/@angular/core/fesm2022/signal.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@angular+core@21.0.0-next.3_a2881388d2c3dd57da73d8c3b030ded7/node_modules/@angular/core/fesm2022/resource.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/@angular+core@21.0.0-next.3_a2881388d2c3dd57da73d8c3b030ded7/node_modules/@angular/core/fesm2022/core.mjs"),_angular_forms__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/@angular+forms@21.0.0-next._995291d5b62b938228baf94d391065de/node_modules/@angular/forms/fesm2022/forms.mjs");function isArray(value){return Array.isArray(value)}function isObject(value){return("object"==typeof value||"function"==typeof value)&&null!=value}function reduceChildren(node,initialValue,fn,shortCircuit){const childrenMap=node.structure.childrenMap();if(!childrenMap)return initialValue;let value=initialValue;for(const child of childrenMap.values()){if(shortCircuit?.(value))break;value=fn(child,value)}return value}function shortCircuitFalse(value){return!value}function shortCircuitTrue(value){return value}class FieldValidationState{node;constructor(node){this.node=node}rawSyncTreeErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.syncTreeErrors.compute(this.node.context),...this.node.structure.parent?.validationState.rawSyncTreeErrors()??[]],...ngDevMode?[{debugName:"rawSyncTreeErrors"}]:[]);syncErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.syncErrors.compute(this.node.context),...this.syncTreeErrors(),...normalizeErrors(this.node.submitState.serverErrors())],...ngDevMode?[{debugName:"syncErrors"}]:[]);syncValid=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>!!this.shouldSkipValidation()||reduceChildren(this.node,0===this.syncErrors().length,(child,value)=>value&&child.validationState.syncValid(),shortCircuitFalse),...ngDevMode?[{debugName:"syncValid"}]:[]);syncTreeErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.rawSyncTreeErrors().filter(err=>err.field===this.node.fieldProxy),...ngDevMode?[{debugName:"syncTreeErrors"}]:[]);rawAsyncErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.shouldSkipValidation()?[]:[...this.node.logicNode.logic.asyncErrors.compute(this.node.context),...this.node.structure.parent?.validationState.rawAsyncErrors()??[]],...ngDevMode?[{debugName:"rawAsyncErrors"}]:[]);asyncErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.shouldSkipValidation()?[]:this.rawAsyncErrors().filter(err=>"pending"===err||err.field===this.node.fieldProxy),...ngDevMode?[{debugName:"asyncErrors"}]:[]);errors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>[...this.syncErrors(),...this.asyncErrors().filter(err=>"pending"!==err)],...ngDevMode?[{debugName:"errors"}]:[]);errorSummary=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>reduceChildren(this.node,this.errors(),(child,result)=>[...result,...child.errorSummary()]),...ngDevMode?[{debugName:"errorSummary"}]:[]);pending=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>reduceChildren(this.node,this.asyncErrors().includes("pending"),(child,value)=>value||child.validationState.asyncErrors().includes("pending")),...ngDevMode?[{debugName:"pending"}]:[]);status=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{if(this.shouldSkipValidation())return"valid";let ownStatus=function calculateValidationSelfStatus(state){return state.errors().length>0?"invalid":state.pending()?"unknown":"valid"}(this);return reduceChildren(this.node,ownStatus,(child,value)=>"invalid"===value||"invalid"===child.validationState.status()?"invalid":"unknown"===value||"unknown"===child.validationState.status()?"unknown":"valid",v=>"invalid"===v)},...ngDevMode?[{debugName:"status"}]:[]);valid=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>"valid"===this.status(),...ngDevMode?[{debugName:"valid"}]:[]);invalid=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>"invalid"===this.status(),...ngDevMode?[{debugName:"invalid"}]:[]);shouldSkipValidation=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.node.hidden()||this.node.disabled()||this.node.readonly(),...ngDevMode?[{debugName:"shouldSkipValidation"}]:[])}function normalizeErrors(error){return void 0===error?[]:isArray(error)?error:[error]}function addDefaultField(errors,field){if(isArray(errors))for(const error of errors)error.field??=field;else errors&&(errors.field??=field);return errors}const DYNAMIC=Symbol(),IGNORED=Symbol();class AbstractLogic{predicates;fns=[];constructor(predicates){this.predicates=predicates}push(logicFn){this.fns.push(wrapWithPredicates(this.predicates,logicFn))}mergeIn(other){const fns=this.predicates?other.fns.map(fn=>wrapWithPredicates(this.predicates,fn)):other.fns;this.fns.push(...fns)}}class BooleanOrLogic extends AbstractLogic{get defaultValue(){return!1}compute(arg){return this.fns.some(f=>{const result=f(arg);return result&&result!==IGNORED})}}class ArrayMergeIgnoreLogic extends AbstractLogic{ignore;static ignoreNull(predicates){return new ArrayMergeIgnoreLogic(predicates,e=>null===e)}constructor(predicates,ignore){super(predicates),this.ignore=ignore}get defaultValue(){return[]}compute(arg){return this.fns.reduce((prev,f)=>{const value=f(arg);return void 0===value||value===IGNORED?prev:isArray(value)?[...prev,...this.ignore?value.filter(e=>!this.ignore(e)):value]:this.ignore&&this.ignore(value)?prev:[...prev,value]},[])}}class ArrayMergeLogic extends ArrayMergeIgnoreLogic{constructor(predicates){super(predicates,void 0)}}class AggregatePropertyMergeLogic extends AbstractLogic{key;get defaultValue(){return this.key.getInitial()}constructor(predicates,key){super(predicates),this.key=key}compute(ctx){if(0===this.fns.length)return this.key.getInitial();let acc=this.key.getInitial();for(let i=0;i<this.fns.length;i++){const item=this.fns[i](ctx);item!==IGNORED&&(acc=this.key.reduce(acc,item))}return acc}}function wrapWithPredicates(predicates,logicFn){return 0===predicates.length?logicFn:arg=>{for(const predicate of predicates){let predicateField=arg.stateOf(predicate.path);const depthDiff=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(predicateField.structure.pathKeys).length-predicate.depth;for(let i=0;i<depthDiff;i++)predicateField=predicateField.structure.parent;if(!predicate.fn(predicateField.context))return IGNORED}return logicFn(arg)}}class LogicContainer{predicates;hidden;disabledReasons;readonly;syncErrors;syncTreeErrors;asyncErrors;aggregateProperties=new Map;propertyFactories=new Map;constructor(predicates){this.predicates=predicates,this.hidden=new BooleanOrLogic(predicates),this.disabledReasons=new ArrayMergeLogic(predicates),this.readonly=new BooleanOrLogic(predicates),this.syncErrors=ArrayMergeIgnoreLogic.ignoreNull(predicates),this.syncTreeErrors=ArrayMergeIgnoreLogic.ignoreNull(predicates),this.asyncErrors=ArrayMergeIgnoreLogic.ignoreNull(predicates)}hasAggregateProperty(prop){return this.aggregateProperties.has(prop)}getAggregatePropertyEntries(){return this.aggregateProperties.entries()}getPropertyFactoryEntries(){return this.propertyFactories.entries()}getAggregateProperty(prop){return this.aggregateProperties.has(prop)||this.aggregateProperties.set(prop,new AggregatePropertyMergeLogic(this.predicates,prop)),this.aggregateProperties.get(prop)}addPropertyFactory(prop,factory){if(this.propertyFactories.has(prop))throw new Error("Can't define value twice for the same Property");this.propertyFactories.set(prop,factory)}mergeIn(other){this.hidden.mergeIn(other.hidden),this.disabledReasons.mergeIn(other.disabledReasons),this.readonly.mergeIn(other.readonly),this.syncErrors.mergeIn(other.syncErrors),this.syncTreeErrors.mergeIn(other.syncTreeErrors),this.asyncErrors.mergeIn(other.asyncErrors);for(const[prop,propertyLogic]of other.getAggregatePropertyEntries())this.getAggregateProperty(prop).mergeIn(propertyLogic);for(const[prop,propertyFactory]of other.getPropertyFactoryEntries())this.addPropertyFactory(prop,propertyFactory)}}let boundPathDepth=0;function setBoundPathDepthForResolution(fn,depth){return(...args)=>{try{return boundPathDepth=depth,fn(...args)}finally{boundPathDepth=0}}}class AbstractLogicNodeBuilder{depth;constructor(depth){this.depth=depth}build(){return new LeafLogicNode(this,[],0)}}class LogicNodeBuilder extends AbstractLogicNodeBuilder{constructor(depth){super(depth)}current;all=[];addHiddenRule(logic){this.getCurrent().addHiddenRule(logic)}addDisabledReasonRule(logic){this.getCurrent().addDisabledReasonRule(logic)}addReadonlyRule(logic){this.getCurrent().addReadonlyRule(logic)}addSyncErrorRule(logic){this.getCurrent().addSyncErrorRule(logic)}addSyncTreeErrorRule(logic){this.getCurrent().addSyncTreeErrorRule(logic)}addAsyncErrorRule(logic){this.getCurrent().addAsyncErrorRule(logic)}addAggregatePropertyRule(key,logic){this.getCurrent().addAggregatePropertyRule(key,logic)}addPropertyFactory(key,factory){this.getCurrent().addPropertyFactory(key,factory)}getChild(key){return this.getCurrent().getChild(key)}hasLogic(builder){return this===builder||this.all.some(({builder:subBuilder})=>subBuilder.hasLogic(builder))}mergeIn(other,predicate){predicate?this.all.push({builder:other,predicate:{fn:setBoundPathDepthForResolution(predicate.fn,this.depth),path:predicate.path}}):this.all.push({builder:other}),this.current=void 0}getCurrent(){return void 0===this.current&&(this.current=new NonMergeableLogicNodeBuilder(this.depth),this.all.push({builder:this.current})),this.current}static newRoot(){return new LogicNodeBuilder(0)}}class NonMergeableLogicNodeBuilder extends AbstractLogicNodeBuilder{logic=new LogicContainer([]);children=new Map;constructor(depth){super(depth)}addHiddenRule(logic){this.logic.hidden.push(setBoundPathDepthForResolution(logic,this.depth))}addDisabledReasonRule(logic){this.logic.disabledReasons.push(setBoundPathDepthForResolution(logic,this.depth))}addReadonlyRule(logic){this.logic.readonly.push(setBoundPathDepthForResolution(logic,this.depth))}addSyncErrorRule(logic){this.logic.syncErrors.push(setBoundPathDepthForResolution(logic,this.depth))}addSyncTreeErrorRule(logic){this.logic.syncTreeErrors.push(setBoundPathDepthForResolution(logic,this.depth))}addAsyncErrorRule(logic){this.logic.asyncErrors.push(setBoundPathDepthForResolution(logic,this.depth))}addAggregatePropertyRule(key,logic){this.logic.getAggregateProperty(key).push(setBoundPathDepthForResolution(logic,this.depth))}addPropertyFactory(key,factory){this.logic.addPropertyFactory(key,setBoundPathDepthForResolution(factory,this.depth))}getChild(key){return this.children.has(key)||this.children.set(key,new LogicNodeBuilder(this.depth+1)),this.children.get(key)}hasLogic(builder){return this===builder}}class LeafLogicNode{builder;predicates;depth;logic;constructor(builder,predicates,depth){this.builder=builder,this.predicates=predicates,this.depth=depth,this.logic=builder?function createLogic(builder,predicates,depth){const logic=new LogicContainer(predicates);if(builder instanceof LogicNodeBuilder){const builtNodes=builder.all.map(({builder,predicate})=>new LeafLogicNode(builder,predicate?[...predicates,bindLevel(predicate,depth)]:predicates,depth));for(const node of builtNodes)logic.mergeIn(node.logic)}else{if(!(builder instanceof NonMergeableLogicNodeBuilder))throw new Error("Unknown LogicNodeBuilder type");logic.mergeIn(builder.logic)}return logic}(builder,predicates,depth):new LogicContainer([])}getChild(key){const childBuilders=this.builder?getAllChildBuilders(this.builder,key):[];if(0===childBuilders.length)return new LeafLogicNode(void 0,[],this.depth+1);if(1===childBuilders.length){const{builder,predicates}=childBuilders[0];return new LeafLogicNode(builder,[...this.predicates,...predicates.map(p=>bindLevel(p,this.depth))],this.depth+1)}{const builtNodes=childBuilders.map(({builder,predicates})=>new LeafLogicNode(builder,[...this.predicates,...predicates.map(p=>bindLevel(p,this.depth))],this.depth+1));return new CompositeLogicNode(builtNodes)}}hasLogic(builder){return this.builder?.hasLogic(builder)??!1}}class CompositeLogicNode{all;logic;constructor(all){this.all=all,this.logic=new LogicContainer([]);for(const node of all)this.logic.mergeIn(node.logic)}getChild(key){return new CompositeLogicNode(this.all.flatMap(child=>child.getChild(key)))}hasLogic(builder){return this.all.some(node=>node.hasLogic(builder))}}function getAllChildBuilders(builder,key){if(builder instanceof LogicNodeBuilder)return builder.all.flatMap(({builder,predicate})=>{const children=getAllChildBuilders(builder,key);return predicate?children.map(({builder,predicates})=>({builder,predicates:[...predicates,predicate]})):children});if(!(builder instanceof NonMergeableLogicNodeBuilder))throw new Error("Unknown LogicNodeBuilder type");return builder.children.has(key)?[{builder:builder.children.get(key),predicates:[]}]:[]}function bindLevel(predicate,depth){return{...predicate,depth}}const PATH=Symbol("PATH");class FieldPathNode{keys;logic;root;children=new Map;fieldPathProxy=new Proxy(this,FIELD_PATH_PROXY_HANDLER);constructor(keys,logic,root){this.keys=keys,this.logic=logic,this.root=root??this}get element(){return this.getChild(DYNAMIC)}getChild(key){return this.children.has(key)||this.children.set(key,new FieldPathNode([...this.keys,key],this.logic.getChild(key),this.root)),this.children.get(key)}mergeIn(other,predicate){const path=other.compile();this.logic.mergeIn(path.logic,predicate)}static unwrapFieldPath(formPath){return formPath[PATH]}static newRoot(){return new FieldPathNode([],LogicNodeBuilder.newRoot(),void 0)}}const FIELD_PATH_PROXY_HANDLER={get:(node,property)=>property===PATH?node:node.getChild(property).fieldPathProxy};let currentCompilingNode;const compiledSchemas=new Map;class SchemaImpl{schemaFn;constructor(schemaFn){this.schemaFn=schemaFn}compile(){if(compiledSchemas.has(this))return compiledSchemas.get(this);const path=FieldPathNode.newRoot();compiledSchemas.set(this,path);let prevCompilingNode=currentCompilingNode;try{currentCompilingNode=path,this.schemaFn(path.fieldPathProxy)}finally{currentCompilingNode=prevCompilingNode}return path}static create(schema){return schema instanceof SchemaImpl?schema:new SchemaImpl(schema)}static rootCompile(schema){try{return compiledSchemas.clear(),void 0===schema?FieldPathNode.newRoot():schema instanceof SchemaImpl?schema.compile():new SchemaImpl(schema).compile()}finally{compiledSchemas.clear()}}}function assertPathIsCurrent(path){if(currentCompilingNode!==FieldPathNode.unwrapFieldPath(path).root)throw new Error("A FieldPath can only be used directly within the Schema that owns it, **not** outside of it or within a sub-schema.")}class Property{brand;constructor(){}}class AggregateProperty{reduce;getInitial;brand;constructor(reduce,getInitial){this.reduce=reduce,this.getInitial=getInitial}}function reducedProperty(reduce,getInitial){return new AggregateProperty(reduce,getInitial)}function minProperty(){return reducedProperty((prev,next)=>void 0===prev?next:void 0===next?prev:Math.min(prev,next),()=>{})}function maxProperty(){return reducedProperty((prev,next)=>void 0===prev?next:void 0===next?prev:Math.max(prev,next),()=>{})}const REQUIRED=function orProperty(){return reducedProperty((prev,next)=>prev||next,()=>!1)}(),MIN=maxProperty(),MAX=minProperty(),MIN_LENGTH=maxProperty(),MAX_LENGTH=minProperty(),PATTERN=function listProperty(){return reducedProperty((acc,item)=>void 0===item?acc:[...acc,item],()=>[])}();function disabled(path,logic){assertPathIsCurrent(path);FieldPathNode.unwrapFieldPath(path).logic.addDisabledReasonRule(ctx=>{let result=!0;return"string"==typeof logic?result=logic:logic&&(result=logic(ctx)),"string"==typeof result?{field:ctx.field,message:result}:result?{field:ctx.field}:void 0})}function validate(path,logic){assertPathIsCurrent(path);FieldPathNode.unwrapFieldPath(path).logic.addSyncErrorRule(ctx=>addDefaultField(logic(ctx),ctx.field))}function aggregateProperty(path,prop,logic){assertPathIsCurrent(path);FieldPathNode.unwrapFieldPath(path).logic.addAggregatePropertyRule(prop,logic)}function property(path,...rest){let key,factory;assertPathIsCurrent(path),2===rest.length?[key,factory]=rest:[factory]=rest,key??=function createProperty(){return new Property}();return FieldPathNode.unwrapFieldPath(path).logic.addPropertyFactory(key,factory),key}class InteropNgControl{field;constructor(field){this.field=field}control=this;get value(){return this.field().value()}get valid(){return this.field().valid()}get invalid(){return this.field().invalid()}get pending(){return this.field().pending()}get disabled(){return this.field().disabled()}get enabled(){return!this.field().disabled()}get errors(){const errors=this.field().errors();if(0===errors.length)return null;const errObj={};for(const error of errors)errObj[error.kind]=error;return errObj}get pristine(){return!this.field().dirty()}get dirty(){return this.field().dirty()}get touched(){return this.field().touched()}get untouched(){return!this.field().touched()}get status(){if(this.field().disabled())return"DISABLED";if(this.field().valid())return"VALID";if(this.field().invalid())return"INVALID";if(this.field().pending())return"PENDING";throw Error("AssertionError: unknown form control status")}valueAccessor=null;hasValidator(validator){return validator===_angular_forms__WEBPACK_IMPORTED_MODULE_6__.k0.required&&this.field().property(REQUIRED)()}updateValueAndValidity(){}}function privateGetComponentInstance(injector){if(function assertIsNodeInjector(injector){if(!("_tNode"in injector))throw new Error("Expected a Node Injector")}(injector),0!==injector._tNode.directiveStart&&-1!==injector._tNode.componentOffset)return injector._lView[injector._tNode.directiveStart+injector._tNode.componentOffset]}function privateIsSignalInput(value){return isInputSignal(value)}function privateIsModelInput(value){return isInputSignal(value)&&isObject(value)&&"subscribe"in value}function isInputSignal(value){if(!isObject(value)||!(_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh in value))return!1;const node=value[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh];return isObject(node)&&"applyValueToInputSignal"in node}class Control{injector=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.zZn);renderer=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.sFG);initialized=!1;field=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.vPA)(void 0,...ngDevMode?[{debugName:"field"}]:[]);set _field(value){this.field.set(value),this.initialized||this.initialize()}state=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.field()(),...ngDevMode?[{debugName:"state"}]:[]);el=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.aKT);cvaArray=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_forms__WEBPACK_IMPORTED_MODULE_6__.kq,{optional:!0});_ngControl;get ngControl(){return this._ngControl??=new InteropNgControl(()=>this.state())}get cva(){return this.cvaArray?.[0]??this._ngControl?.valueAccessor??void 0}initialize(){this.initialized=!0;const cmp=privateGetComponentInstance(this.injector);if(!cmp||!function isShadowedControlComponent(cmp){const mirror=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.reflectComponentType)(cmp.constructor);return mirror?.inputs.some(input=>"control"===input.templateName)??!1}(cmp)){if(cmp&&function isFormUiControl(cmp){const castCmp=cmp;return(isFormValueControl(castCmp)||isFormCheckboxControl(castCmp))&&(void 0===castCmp.readonly||privateIsSignalInput(castCmp.readonly))&&(void 0===castCmp.disabled||privateIsSignalInput(castCmp.disabled))&&(void 0===castCmp.disabledReasons||privateIsSignalInput(castCmp.disabledReasons))&&(void 0===castCmp.errors||privateIsSignalInput(castCmp.errors))&&(void 0===castCmp.invalid||privateIsSignalInput(castCmp.invalid))&&(void 0===castCmp.pending||privateIsSignalInput(castCmp.pending))&&(void 0===castCmp.touched||privateIsModelInput(castCmp.touched)||privateIsSignalInput(castCmp.touched)||isOutputRef(castCmp.touched))&&(void 0===castCmp.dirty||privateIsSignalInput(castCmp.dirty))&&(void 0===castCmp.min||privateIsSignalInput(castCmp.min))&&(void 0===castCmp.minLength||privateIsSignalInput(castCmp.minLength))&&(void 0===castCmp.max||privateIsSignalInput(castCmp.max))&&(void 0===castCmp.maxLength||privateIsSignalInput(castCmp.maxLength))}(cmp))this.setupCustomUiControl(cmp);else if(void 0!==this.cva)this.setupControlValueAccessor(this.cva);else{if(!(this.el.nativeElement instanceof HTMLInputElement||this.el.nativeElement instanceof HTMLTextAreaElement||this.el.nativeElement instanceof HTMLSelectElement))throw new Error("Unhandled control?");this.setupNativeInput(this.el.nativeElement)}(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.QZ)(onCleanup=>{const fieldNode=this.state();fieldNode.nodeState.controls.update(controls=>[...controls,this]),onCleanup(()=>{fieldNode.nodeState.controls.update(controls=>controls.filter(c=>c!==this))})},{injector:this.injector})}}setupNativeInput(input){const inputType=input instanceof HTMLTextAreaElement?"text":input instanceof HTMLSelectElement?"select":input.type;switch(input.addEventListener("input",()=>{switch(inputType){case"checkbox":this.state().value.set(input.checked);break;case"radio":default:this.state().value.set(input.value);break;case"number":case"range":case"datetime-local":"number"==typeof this.state().value()?this.state().value.set(input.valueAsNumber):this.state().value.set(input.value);break;case"date":case"month":case"week":case"time":isDateOrNull(this.state().value())?this.state().value.set(input.valueAsDate):"number"==typeof this.state().value()?this.state().value.set(input.valueAsNumber):this.state().value.set(input.value)}this.state().markAsDirty()}),input.addEventListener("blur",()=>this.state().markAsTouched()),this.maybeSynchronize(()=>this.state().readonly(),this.withBooleanAttribute(input,"readonly")),this.maybeSynchronize(()=>this.state().disabled(),this.withBooleanAttribute(input,"disabled")),this.maybeSynchronize(()=>this.state().name(),this.withAttribute(input,"name")),this.maybeSynchronize(this.propertySource(REQUIRED),this.withBooleanAttribute(input,"required")),this.maybeSynchronize(this.propertySource(MIN),this.withAttribute(input,"min")),this.maybeSynchronize(this.propertySource(MIN_LENGTH),this.withAttribute(input,"minLength")),this.maybeSynchronize(this.propertySource(MAX),this.withAttribute(input,"max")),this.maybeSynchronize(this.propertySource(MAX_LENGTH),this.withAttribute(input,"maxLength")),inputType){case"checkbox":this.maybeSynchronize(()=>this.state().value(),value=>input.checked=value);break;case"radio":this.maybeSynchronize(()=>this.state().value(),value=>{input.checked=input.value===value});break;case"select":this.maybeSynchronize(()=>this.state().value(),value=>{(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.mal)(()=>input.value=value,{injector:this.injector})});break;case"number":case"range":case"datetime-local":this.maybeSynchronize(()=>this.state().value(),value=>{"number"==typeof value?input.valueAsNumber=value:input.value=value});break;case"date":case"month":case"week":case"time":this.maybeSynchronize(()=>this.state().value(),value=>{isDateOrNull(value)?input.valueAsDate=value:"number"==typeof value?input.valueAsNumber=value:input.value=value});break;default:this.maybeSynchronize(()=>this.state().value(),value=>{input.value=value})}}setupControlValueAccessor(cva){cva.registerOnChange(value=>this.state().value.set(value)),cva.registerOnTouched(()=>this.state().markAsTouched()),this.maybeSynchronize(()=>this.state().value(),value=>cva.writeValue(value)),cva.setDisabledState&&this.maybeSynchronize(()=>this.state().disabled(),value=>cva.setDisabledState(value)),cva.writeValue(this.state().value()),cva.setDisabledState?.(this.state().disabled())}setupCustomUiControl(cmp){let cleanupValue,cleanupTouch,cleanupDefaultTouch;if(isFormValueControl(cmp))this.maybeSynchronize(()=>this.state().value(),withInput(cmp.value)),cleanupValue=cmp.value.subscribe(newValue=>this.state().value.set(newValue));else{if(!isFormCheckboxControl(cmp))throw new Error("Unknown custom control subtype");this.maybeSynchronize(()=>this.state().value(),withInput(cmp.checked)),cleanupValue=cmp.checked.subscribe(newValue=>this.state().value.set(newValue))}if(this.maybeSynchronize(()=>this.state().name(),withInput(cmp.name)),this.maybeSynchronize(()=>this.state().disabled(),withInput(cmp.disabled)),this.maybeSynchronize(()=>this.state().disabledReasons(),withInput(cmp.disabledReasons)),this.maybeSynchronize(()=>this.state().readonly(),withInput(cmp.readonly)),this.maybeSynchronize(()=>this.state().hidden(),withInput(cmp.hidden)),this.maybeSynchronize(()=>this.state().errors(),withInput(cmp.errors)),(privateIsModelInput(cmp.touched)||privateIsSignalInput(cmp.touched))&&this.maybeSynchronize(()=>this.state().touched(),withInput(cmp.touched)),this.maybeSynchronize(()=>this.state().dirty(),withInput(cmp.dirty)),this.maybeSynchronize(()=>this.state().invalid(),withInput(cmp.invalid)),this.maybeSynchronize(()=>this.state().pending(),withInput(cmp.pending)),this.maybeSynchronize(this.propertySource(REQUIRED),withInput(cmp.required)),this.maybeSynchronize(this.propertySource(MIN),withInput(cmp.min)),this.maybeSynchronize(this.propertySource(MIN_LENGTH),withInput(cmp.minLength)),this.maybeSynchronize(this.propertySource(MAX),withInput(cmp.max)),this.maybeSynchronize(this.propertySource(MAX_LENGTH),withInput(cmp.maxLength)),this.maybeSynchronize(this.propertySource(PATTERN),withInput(cmp.pattern)),privateIsModelInput(cmp.touched)||isOutputRef(cmp.touched))cleanupTouch=cmp.touched.subscribe(()=>this.state().markAsTouched());else{const listener=event=>{const newActiveEl=event.relatedTarget;this.el.nativeElement.contains(newActiveEl)||this.state().markAsTouched()};this.el.nativeElement.addEventListener("focusout",listener),cleanupDefaultTouch=()=>this.el.nativeElement.removeEventListener("focusout",listener)}this.injector.get(_angular_core__WEBPACK_IMPORTED_MODULE_2__.abz).onDestroy(()=>{cleanupValue?.unsubscribe(),cleanupTouch?.unsubscribe(),cleanupDefaultTouch?.()})}maybeSynchronize(source,sink){if(!sink)return;!function privateRunEffect(ref){ref[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh].run()}((0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.QZ)(()=>{const value=source();(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(()=>sink(value))},...ngDevMode?[{debugName:"ref",injector:this.injector}]:[{injector:this.injector}]))}propertySource(key){const metaSource=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.state().hasProperty(key)?this.state().property(key):key.getInitial,...ngDevMode?[{debugName:"metaSource"}]:[]);return()=>metaSource()?.()}withAttribute(element,attribute){return value=>{void 0!==value?this.renderer.setAttribute(element,attribute,value.toString()):this.renderer.removeAttribute(element,attribute)}}withBooleanAttribute(element,attribute){return value=>{value?this.renderer.setAttribute(element,attribute,""):this.renderer.removeAttribute(element,attribute)}}static ɵfac=function Control_Factory(__ngFactoryType__){return new(__ngFactoryType__||Control)};static ɵdir=_angular_core__WEBPACK_IMPORTED_MODULE_1__.FsC({type:Control,selectors:[["","control",""]],inputs:{_field:[0,"control","_field"]},features:[_angular_core__WEBPACK_IMPORTED_MODULE_1__.Jv_([{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_6__.vO,useFactory:()=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(Control).ngControl}])]})}function withInput(input){return input?value=>function privateSetComponentInput(inputSignal,value){inputSignal[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh].applyValueToInputSignal(inputSignal[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh],value)}(input,value):void 0}function isFormValueControl(cmp){return privateIsModelInput(cmp.value)}function isFormCheckboxControl(cmp){return privateIsModelInput(cmp.checked)&&void 0===cmp.value}function isOutputRef(value){return value instanceof _angular_core__WEBPACK_IMPORTED_MODULE_4__.Zf||value instanceof _angular_core__WEBPACK_IMPORTED_MODULE_2__.bkB}function isDateOrNull(value){return null===value||value instanceof Date}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_1__.cDI(Control,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_1__.WLR,args:[{selector:"[control]",providers:[{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_6__.vO,useFactory:()=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(Control).ngControl}]}]}],null,{_field:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_1__.pde,args:[{required:!0,alias:"control"}]}]});class FieldNodeContext{node;cache=new WeakMap;constructor(node){this.node=node}resolve(target){if(!this.cache.has(target)){const resolver=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{const targetPathNode=FieldPathNode.unwrapFieldPath(target);let field=this.node,stepsRemaining=function getBoundPathDepth(){return boundPathDepth}();for(;stepsRemaining>0||!field.structure.logic.hasLogic(targetPathNode.root.logic);)if(stepsRemaining--,field=field.structure.parent,void 0===field)throw new Error("Path is not part of this field tree.");for(let key of targetPathNode.keys)if(field=field.structure.getChild(key),void 0===field)throw new Error(`Cannot resolve path .${targetPathNode.keys.join(".")} relative to field ${["<root>",...this.node.structure.pathKeys()].join(".")}.`);return field.fieldProxy},...ngDevMode?[{debugName:"resolver"}]:[]);this.cache.set(target,resolver)}return this.cache.get(target)()}get field(){return this.node.fieldProxy}get state(){return this.node}get value(){return this.node.structure.value}get key(){return this.node.structure.keyInParent}index=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{const key=this.key();if(!isArray((0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(this.node.structure.parent.value)))throw new Error("RuntimeError: cannot access index, parent field is not an array");return Number(key)},...ngDevMode?[{debugName:"index"}]:[]);fieldOf=p=>this.resolve(p);stateOf=p=>this.resolve(p)();valueOf=p=>this.resolve(p)().value()}class FieldPropertyState{node;properties=new Map;constructor(node){this.node=node,(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(()=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.N4e)(this.node.structure.injector,()=>{for(const[key,factory]of this.node.logicNode.logic.getPropertyFactoryEntries())this.properties.set(key,factory(this.node.context))}))}get(prop){if(prop instanceof Property)return this.properties.get(prop);if(!this.properties.has(prop)){const logic=this.node.logicNode.logic.getAggregateProperty(prop),result=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>logic.compute(this.node.context),...ngDevMode?[{debugName:"result"}]:[]);this.properties.set(prop,result)}return this.properties.get(prop)}has(prop){return prop instanceof AggregateProperty?this.node.logicNode.logic.hasAggregateProperty(prop):this.properties.has(prop)}}const FIELD_PROXY_HANDLER={get(getTgt,p){const tgt=getTgt(),child=tgt.structure.getChild(p);if(void 0!==child)return child.fieldProxy;if(isArray((0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(tgt.value))){if("length"===p)return tgt.value().length;if(p===Symbol.iterator)return Array.prototype[p]}}};function deepSignal(source,prop){const read=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>source()[prop()]);return read[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh]=source[_angular_core__WEBPACK_IMPORTED_MODULE_3__.bh],read.set=value=>{source.update(current=>function valueForWrite(sourceValue,newPropValue,prop){if(isArray(sourceValue)){const newValue=[...sourceValue];return newValue[prop]=newPropValue,newValue}return{...sourceValue,[prop]:newPropValue}}(current,value,prop()))},read.update=fn=>{read.set(fn((0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(read)))},read.asReadonly=()=>read,read}class FieldNodeStructure{logic;identitySymbol=Symbol();_injector=void 0;get injector(){return this._injector??=_angular_core__WEBPACK_IMPORTED_MODULE_2__.zZn.create({providers:[],parent:this.fieldManager.injector}),this._injector}constructor(logic){this.logic=logic}children(){return this.childrenMap()?.values()??[]}getChild(key){const map=this.childrenMap(),value=this.value();if(map&&isObject(value)){if(isArray(value)){const childValue=value[key];isObject(childValue)&&childValue.hasOwnProperty(this.identitySymbol)&&(key=childValue[this.identitySymbol])}return map.get("number"==typeof key?key.toString():key)}}destroy(){this.injector.destroy()}}class RootFieldNodeStructure extends FieldNodeStructure{node;fieldManager;value;get parent(){}get root(){return this.node}get pathKeys(){return ROOT_PATH_KEYS}get keyInParent(){return ROOT_KEY_IN_PARENT}childrenMap;constructor(node,pathNode,logic,fieldManager,value,adapter,createChildNode){super(logic),this.node=node,this.fieldManager=fieldManager,this.value=value,this.childrenMap=makeChildrenMapSignal(node,value,this.identitySymbol,pathNode,logic,adapter,createChildNode)}}class ChildFieldNodeStructure extends FieldNodeStructure{parent;root;pathKeys;keyInParent;value;childrenMap;get fieldManager(){return this.root.structure.fieldManager}constructor(node,pathNode,logic,parent,identityInParent,initialKeyInParent,adapter,createChildNode){if(super(logic),this.parent=parent,this.root=this.parent.structure.root,this.pathKeys=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>[...parent.structure.pathKeys(),this.keyInParent()],...ngDevMode?[{debugName:"pathKeys"}]:[]),void 0===identityInParent){const key=initialKeyInParent;this.keyInParent=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{if(parent.structure.childrenMap()?.get(key)!==node)throw new Error(`RuntimeError: orphan field, looking for property '${key}' of ${getDebugName(parent)}`);return key},...ngDevMode?[{debugName:"keyInParent"}]:[])}else{let lastKnownKey=initialKeyInParent;this.keyInParent=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{const parentValue=parent.structure.value();if(!isArray(parentValue))throw new Error(`RuntimeError: orphan field, expected ${getDebugName(parent)} to be an array`);const data=parentValue[lastKnownKey];if(isObject(data)&&data.hasOwnProperty(parent.structure.identitySymbol)&&data[parent.structure.identitySymbol]===identityInParent)return lastKnownKey;for(let i=0;i<parentValue.length;i++){const data=parentValue[i];if(isObject(data)&&data.hasOwnProperty(parent.structure.identitySymbol)&&data[parent.structure.identitySymbol]===identityInParent)return lastKnownKey=i.toString()}throw new Error(`RuntimeError: orphan field, can't find element in array ${getDebugName(parent)}`)},...ngDevMode?[{debugName:"keyInParent"}]:[])}this.value=deepSignal(this.parent.structure.value,this.keyInParent),this.childrenMap=makeChildrenMapSignal(node,this.value,this.identitySymbol,pathNode,logic,adapter,createChildNode),this.fieldManager.structures.add(this)}}let globalId=0;const ROOT_PATH_KEYS=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>[],...ngDevMode?[{debugName:"ROOT_PATH_KEYS"}]:[]),ROOT_KEY_IN_PARENT=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{throw new Error("RuntimeError: the top-level field in the form has no parent")},...ngDevMode?[{debugName:"ROOT_KEY_IN_PARENT"}]:[]);function makeChildrenMapSignal(node,valueSignal,identitySymbol,pathNode,logic,adapter,createChildNode){return(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.uu)({source:valueSignal,computation:(value,previous)=>{let childrenMap=previous?.value;if(!isObject(value))return;const isValueArray=isArray(value);if(void 0!==childrenMap){let oldKeys;if(isValueArray){oldKeys=new Set(childrenMap.keys());for(let i=0;i<value.length;i++){const childValue=value[i];isObject(childValue)&&childValue.hasOwnProperty(identitySymbol)?oldKeys.delete(childValue[identitySymbol]):oldKeys.delete(i.toString())}for(const key of oldKeys)childrenMap.delete(key)}else for(let key of childrenMap.keys())value.hasOwnProperty(key)||childrenMap.delete(key)}for(let key of Object.keys(value)){let trackingId;const childValue=value[key];if(void 0===childValue){childrenMap?.delete(key);continue}isValueArray&&isObject(childValue)&&(trackingId=childValue[identitySymbol]??=Symbol(ngDevMode?"id:"+globalId++:""));const identity=trackingId??key;if(childrenMap?.has(identity))continue;let childPath,childLogic;isValueArray?(childPath=pathNode.getChild(DYNAMIC),childLogic=logic.getChild(DYNAMIC)):(childPath=pathNode.getChild(key),childLogic=logic.getChild(key)),childrenMap??=new Map,childrenMap.set(identity,createChildNode({kind:"child",parent:node,pathNode:childPath,logic:childLogic,initialKeyInParent:key,identityInParent:trackingId,fieldAdapter:adapter}))}return childrenMap},equal:()=>!1})}function getDebugName(node){return`<root>.${node.structure.pathKeys().join(".")}`}class FieldSubmitState{node;selfSubmitting=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.vPA)(!1,...ngDevMode?[{debugName:"selfSubmitting"}]:[]);serverErrors;constructor(node){this.node=node,this.serverErrors=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.uu)({source:this.node.structure.value,computation:()=>[]})}submitting=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>this.selfSubmitting()||(this.node.structure.parent?.submitting()??!1),...ngDevMode?[{debugName:"submitting"}]:[])}class FieldNode{structure;validationState;propertyState;nodeState;submitState;_context=void 0;fieldAdapter;get context(){return this._context??=new FieldNodeContext(this)}fieldProxy=new Proxy(()=>this,FIELD_PROXY_HANDLER);constructor(options){this.fieldAdapter=options.fieldAdapter,this.structure=this.fieldAdapter.createStructure(this,options),this.validationState=this.fieldAdapter.createValidationState(this,options),this.nodeState=this.fieldAdapter.createNodeState(this,options),this.propertyState=new FieldPropertyState(this),this.submitState=new FieldSubmitState(this)}get logicNode(){return this.structure.logic}get value(){return this.structure.value}get keyInParent(){return this.structure.keyInParent}get errors(){return this.validationState.errors}get errorSummary(){return this.validationState.errorSummary}get pending(){return this.validationState.pending}get valid(){return this.validationState.valid}get invalid(){return this.validationState.invalid}get dirty(){return this.nodeState.dirty}get touched(){return this.nodeState.touched}get disabled(){return this.nodeState.disabled}get disabledReasons(){return this.nodeState.disabledReasons}get hidden(){return this.nodeState.hidden}get readonly(){return this.nodeState.readonly}get controls(){return this.nodeState.controls}get submitting(){return this.submitState.submitting}get name(){return this.nodeState.name}property(prop){return this.propertyState.get(prop)}hasProperty(prop){return this.propertyState.has(prop)}markAsTouched(){this.nodeState.markAsTouched()}markAsDirty(){this.nodeState.markAsDirty()}reset(){this.nodeState.markAsUntouched(),this.nodeState.markAsPristine();for(const child of this.structure.children())child.reset()}static newRoot(fieldManager,value,pathNode,adapter){return adapter.newRoot(fieldManager,value,pathNode,adapter)}static newChild(options){return options.fieldAdapter.newChild(options)}createStructure(options){return"root"===options.kind?new RootFieldNodeStructure(this,options.pathNode,options.logic,options.fieldManager,options.value,options.fieldAdapter,FieldNode.newChild):new ChildFieldNodeStructure(this,options.pathNode,options.logic,options.parent,options.identityInParent,options.initialKeyInParent,options.fieldAdapter,FieldNode.newChild)}}class FieldNodeState{node;selfTouched=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.vPA)(!1,...ngDevMode?[{debugName:"selfTouched"}]:[]);selfDirty=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.vPA)(!1,...ngDevMode?[{debugName:"selfDirty"}]:[]);markAsTouched(){this.selfTouched.set(!0)}markAsDirty(){this.selfDirty.set(!0)}markAsPristine(){this.selfDirty.set(!1)}markAsUntouched(){this.selfTouched.set(!1)}controls=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.vPA)([],...ngDevMode?[{debugName:"controls"}]:[]);constructor(node){this.node=node}dirty=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>reduceChildren(this.node,this.selfDirty(),(child,value)=>value||child.nodeState.dirty(),shortCircuitTrue),...ngDevMode?[{debugName:"dirty"}]:[]);touched=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>reduceChildren(this.node,this.selfTouched(),(child,value)=>value||child.nodeState.touched(),shortCircuitTrue),...ngDevMode?[{debugName:"touched"}]:[]);disabledReasons=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>[...this.node.structure.parent?.nodeState.disabledReasons()??[],...this.node.logicNode.logic.disabledReasons.compute(this.node.context)],...ngDevMode?[{debugName:"disabledReasons"}]:[]);disabled=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>!!this.disabledReasons().length,...ngDevMode?[{debugName:"disabled"}]:[]);readonly=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>(this.node.structure.parent?.nodeState.readonly()||this.node.logicNode.logic.readonly.compute(this.node.context))??!1,...ngDevMode?[{debugName:"readonly"}]:[]);hidden=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>(this.node.structure.parent?.nodeState.hidden()||this.node.logicNode.logic.hidden.compute(this.node.context))??!1,...ngDevMode?[{debugName:"hidden"}]:[]);name=(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>{const parent=this.node.structure.parent;return parent?`${parent.name()}.${this.node.structure.keyInParent()}`:this.node.structure.fieldManager.rootName},...ngDevMode?[{debugName:"name"}]:[])}class BasicFieldAdapter{newRoot(fieldManager,value,pathNode,adapter){return new FieldNode({kind:"root",fieldManager,value,pathNode,logic:pathNode.logic.build(),fieldAdapter:adapter})}newChild(options){return new FieldNode(options)}createNodeState(node){return new FieldNodeState(node)}createValidationState(node){return new FieldValidationState(node)}createStructure(node,options){return node.createStructure(options)}}class FormFieldManager{injector;rootName;constructor(injector,rootName){this.injector=injector,this.rootName=rootName??`${this.injector.get(_angular_core__WEBPACK_IMPORTED_MODULE_1__.sZ2)}.form${nextFormId++}`}structures=new Set;createFieldManagementEffect(root){(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.QZ)(()=>{const liveStructures=new Set;this.markStructuresLive(root,liveStructures);for(const structure of this.structures)liveStructures.has(structure)||(this.structures.delete(structure),(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.O8)(()=>structure.destroy()))},{injector:this.injector})}markStructuresLive(structure,liveStructures){liveStructures.add(structure);for(const child of structure.children())this.markStructuresLive(child.structure,liveStructures)}}let nextFormId=0;function normalizeFormArgs(args){let model,schema,options;return 3===args.length?[model,schema,options]=args:2===args.length?!function isSchemaOrSchemaFn(value){return value instanceof SchemaImpl||"function"==typeof value}(args[1])?[model,options]=args:[model,schema]=args:[model]=args,[model,schema,options]}function form(...args){const[model,schema,options]=normalizeFormArgs(args),injector=options?.injector??(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.zZn),pathNode=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.N4e)(injector,()=>SchemaImpl.rootCompile(schema)),fieldManager=new FormFieldManager(injector,options?.name),adapter=options?.adapter??new BasicFieldAdapter,fieldRoot=FieldNode.newRoot(fieldManager,model,pathNode,adapter);return fieldManager.createFieldManagementEffect(fieldRoot.structure),fieldRoot.fieldProxy}function applyWhen(path,logic,schema){assertPathIsCurrent(path);FieldPathNode.unwrapFieldPath(path).mergeIn(SchemaImpl.create(schema),{fn:logic,path})}function submit(_x,_x2){return _submit.apply(this,arguments)}function _submit(){return _submit=(0,C_Users_samuel_programming_frakton_ng_node_modules_pnpm_babel_runtime_7_28_4_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.A)(function*(form,action){const node=form();if(markAllAsTouched(node),!node.invalid()){node.submitState.selfSubmitting.set(!0);try{const errors=yield action(form);errors&&function setServerErrors(submittedField,errors){isArray(errors)||(errors=[errors]);const errorsByField=new Map;for(const error of errors){const errorWithField=addDefaultField(error,submittedField.fieldProxy),field=errorWithField.field();let fieldErrors=errorsByField.get(field);fieldErrors||(fieldErrors=[],errorsByField.set(field,fieldErrors)),fieldErrors.push(errorWithField)}for(const[field,fieldErrors]of errorsByField)field.submitState.serverErrors.set(fieldErrors)}(node,errors)}finally{node.submitState.selfSubmitting.set(!1)}}}),_submit.apply(this,arguments)}function markAllAsTouched(node){node.markAsTouched();for(const child of node.structure.children())markAllAsTouched(child)}class _NgValidationError{__brand=void 0;kind="";field;message;constructor(options){options&&Object.assign(this,options)}}class RequiredValidationError extends _NgValidationError{kind="required"}class MinLengthValidationError extends _NgValidationError{minLength;kind="minLength";constructor(minLength,options){super(options),this.minLength=minLength}}class MaxLengthValidationError extends _NgValidationError{maxLength;kind="maxLength";constructor(maxLength,options){super(options),this.maxLength=maxLength}}class EmailValidationError extends _NgValidationError{kind="email"}function getLengthOrSize(value){const v=value;return"number"==typeof v.length?v.length:v.size}function getOption(opt,ctx){return opt instanceof Function?opt(ctx):opt}function isEmpty(value){return"number"==typeof value?isNaN(value):""===value||!1===value||null==value}const EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function email(path,config){validate(path,ctx=>{if(!isEmpty(ctx.value()))return EMAIL_REGEXP.test(ctx.value())?void 0:config?.error?getOption(config.error,ctx):function emailError(options){return new EmailValidationError(options)}({message:getOption(config?.message,ctx)})})}function maxLength(path,maxLength,config){const MAX_LENGTH_MEMO=property(path,ctx=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>"number"==typeof maxLength?maxLength:maxLength(ctx)));aggregateProperty(path,MAX_LENGTH,({state})=>state.property(MAX_LENGTH_MEMO)()),validate(path,ctx=>{if(isEmpty(ctx.value()))return;const maxLength=ctx.state.property(MAX_LENGTH_MEMO)();return void 0!==maxLength&&getLengthOrSize(ctx.value())>maxLength?config?.error?getOption(config.error,ctx):function maxLengthError(maxLength,options){return new MaxLengthValidationError(maxLength,options)}(maxLength,{message:getOption(config?.message,ctx)}):void 0})}function minLength(path,minLength,config){const MIN_LENGTH_MEMO=property(path,ctx=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>"number"==typeof minLength?minLength:minLength(ctx)));aggregateProperty(path,MIN_LENGTH,({state})=>state.property(MIN_LENGTH_MEMO)()),validate(path,ctx=>{if(isEmpty(ctx.value()))return;const minLength=ctx.state.property(MIN_LENGTH_MEMO)();return void 0!==minLength&&getLengthOrSize(ctx.value())<minLength?config?.error?getOption(config.error,ctx):function minLengthError(minLength,options){return new MinLengthValidationError(minLength,options)}(minLength,{message:getOption(config?.message,ctx)}):void 0})}function required(path,config){const REQUIRED_MEMO=property(path,ctx=>(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.EW)(()=>!config?.when||config.when(ctx)));aggregateProperty(path,REQUIRED,({state})=>state.property(REQUIRED_MEMO)()),validate(path,ctx=>{if(ctx.state.property(REQUIRED_MEMO)()&&isEmpty(ctx.value()))return config?.error?getOption(config.error,ctx):function requiredError(options){return new RequiredValidationError(options)}({message:getOption(config?.message,ctx)})})}}}]);